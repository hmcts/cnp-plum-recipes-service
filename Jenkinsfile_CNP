#!groovy

node {
  stage('Checkout') {
    checkout scm 
  }
  
  stage('Build') {
   sh "./gradlew check" 
  }
  
  stage('Analysis') {
   withSonarQubeEnv("SonarQube") {
    sh "./gradlew --info sonarqube"
   }
  }
}

def qg = waitForQualityGate()
if (qg.status != 'OK') {
     error "Pipeline aborted due to quality gate failure: ${qg.status}"
}
